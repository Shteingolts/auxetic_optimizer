LAMMPS (23 Jun 2022 - Update 4)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Compute elastic constant tensor for a crystal
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, deformation parameters and initial
#		  configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the minimization of energy w.r.t atom
#  positions in the deformed cell is fully converged.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to check
#  the final max and two-norm forces reported in the log file. If you know
#  that minimization is not required, you can set maxiter = 0.0 in
#  init.mod.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 1e-4

# Define the amount of random jiggle for atoms
# This prevents atoms from staying on saddle points
variable atomjiggle equal 1.0e-5

# Uncomment one of these blocks, depending on what units
# you are using in LAMMPS and for output

# metal units, elastic constants in eV/A^3
#units		metal
#variable cfac equal 6.2414e-7
#variable cunits string eV/A^3

# metal units, elastic constants in GPa
# units		metal
# variable cfac equal 1.0e-4
# variable cunits string GPa

# real units, elastic constants in GPa
#units		real
#variable cfac equal 1.01325e-4
#variable cunits string GPa

# COPIED FROM MODIFIED SCRIPT
#---------------------------------
# Choose potential
# metal units, elastic constants in GPa
units		metal
atom_style	full
bond_style      harmonic
angle_style     harmonic
dihedral_style  zero
special_bonds   amber
variable cfac equal 1.0e-4
variable cunits string GPa
boundary	p p p
#---------------------------------
read_data network.lmp
Reading data file ...
  triclinic box = (0 0 0) to (21.972449 21.972449 1) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
WARNING: Atom style in data file differs from currently defined atom style (src/read_data.cpp:538)
  reading atoms ...
  499 atoms
WARNING: Bond style in data file differs from currently defined bond style (src/read_data.cpp:630)
  scanning bonds ...
  5 = max bonds/atom
WARNING: Angle style in data file differs from currently defined angle style (src/read_data.cpp:641)
  scanning angles ...
  15 = max angles/atom
  reading bonds ...
  915 bonds
  reading angles ...
  3221 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.8333333333333334
     6 = max # of 1-2 neighbors
    21 = max # of 1-3 neighbors
    87 = max # of 1-4 neighbors
    32 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.015 seconds


# Define minimization parameters
variable etol equal 0.0
variable ftol equal 1.0e-10
variable maxiter equal 200
variable maxeval equal 2000
variable dmax equal 1.0e-2

# Need to set mass to something, just to satisfy LAMMPS
mass 1 1.0e-20

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# EXAMPLE SCRIPT
#------------------------------------------------------
# # Choose potential
# pair_style	sw
# pair_coeff * * Si.sw Si

# # Setup neighbor style
# neighbor 1.0 nsq
# neigh_modify once no every 1 delay 0 check yes

# # Setup minimization style
# min_style	     cg
# min_modify	     dmax ${dmax} line quadratic

# # Setup output
# thermo		1
# thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
# thermo_modify norm no

# COPIED FROM MODIFIED SCRIPT
#------------------------------------------------------
# Setup neighbor style
neighbor 3.0 nsq
neigh_modify once no every 1 delay 0 check yes
comm_modify cutoff 2.0

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

timestep	0.001


# Setup output
thermo		100
thermo_style custom step temp pe ebond eangle edihed press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Compute initial state
fix 3 all box/relax  aniso 0.0
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 200 ${maxeval}
minimize 0 1e-10 200 2000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0
  ghost atom cutoff = 2
  0 neighbor lists, perpetual/occasional/extra = 0 0 0
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2142)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 12.88 | 12.88 | 12.88 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         0   0              2.3739553e-10  2.3739553e-10  0              0             -0.025695174   -0.070057929   -0.0070275918   0             -0.029080081    0              0              21.972449      21.972449      1              482.78852    
       100   0              6.6375313e-14  6.6375313e-14  0              0              2.1029201e-06  4.7687647e-06  1.5399957e-06  0              8.2187209e-05  0              0              21.97245       21.972448      1              482.78851    
       200   0              5.3140254e-16  5.3140254e-16  0              0              1.7316374e-05  4.3084744e-05  8.8643771e-06  0              2.5198838e-05  0              0              21.97245       21.972448      1              482.78851    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.140339 on 1 procs for 200 steps with 499 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
    2.37395532117986e-10 5.33084421286949e-16 5.31402540132647e-16
  Force two-norm initial, final = 5.637721e-05 2.1875324e-08
  Force max component initial, final = 2.111076e-05 1.2982851e-08
  Final line search alpha, max atom move = 1 1.2982851e-08
  Iterations, force evaluations = 200 401

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.09332    | 0.09332    | 0.09332    |   0.0 | 66.50
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.010469   | 0.010469   | 0.010469   |   0.0 |  7.46
Output  | 3.7142e-05 | 3.7142e-05 | 3.7142e-05 |   0.0 |  0.03
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.03651    |            |       | 26.02

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3737 ave        3737 max        3737 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0

variable tmp equal pxx
variable pxx0 equal ${tmp}
variable pxx0 equal 4.30847435792799e-05
variable tmp equal pyy
variable pyy0 equal ${tmp}
variable pyy0 equal 8.86437711942309e-06
# variable tmp equal pzz
# variable pzz0 equal ${tmp}
# variable tmp equal pyz
# variable pyz0 equal ${tmp}
# variable tmp equal pxz
# variable pxz0 equal ${tmp}
variable tmp equal pxy
variable pxy0 equal ${tmp}
variable pxy0 equal 2.5198837882697e-05

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 21.9724498695651
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 21.9724480149555
# variable tmp equal lz
# variable lz0 equal ${tmp}

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
# These are the definition of shear components along certain axes,
# i.e., G=dP/(dX/l)
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-4.30847435792799e-05)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-4.30847435792799e-05)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-8.86437711942309e-06)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-8.86437711942309e-06)/(v_delta/v_len0)*0.0001
# variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
# variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
# variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-2.5198837882697e-05)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-2.5198837882697e-05)/(v_delta/v_len0)*0.0001

displace_atoms all random ${atomjiggle} ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 1e-05 87287 units box
Displacing atoms ...

# Write restart
unfix 3
write_restart restart.equil
System init for write_restart ...
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

variable dt equal 0.005
variable strain equal 1e-4
variable srate equal 1e-5
variable M equal 1000 # averaging time for properties
timestep ${dt}
timestep 0.005
variable strainsteps equal ${strain}/${dt}/${srate}
variable strainsteps equal 0.0001/${dt}/${srate}
variable strainsteps equal 0.0001/0.005/${srate}
variable strainsteps equal 0.0001/0.005/1e-05
variable nsteps equal round(${strainsteps})
variable nsteps equal round(2000)
print "nsteps ${nsteps}"
nsteps 2000

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 21.9724498695651
if "${dir} == 2" then    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style full from restart
  triclinic box = (-4.3478258e-07 4.9252223e-07 0) to (21.972449 21.972449 1) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  restoring bond style harmonic from restart
  restoring angle style harmonic from restart
  restoring dihedral style zero from restart
  499 atoms
  915 bonds
  3221 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.8333333333333334
     6 = max # of 1-2 neighbors
    21 = max # of 1-3 neighbors
    87 = max # of 1-4 neighbors
    32 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.002 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# EXAMPLE SCRIPT
#------------------------------------------------------
# # Choose potential
# pair_style	sw
# pair_coeff * * Si.sw Si

# # Setup neighbor style
# neighbor 1.0 nsq
# neigh_modify once no every 1 delay 0 check yes

# # Setup minimization style
# min_style	     cg
# min_modify	     dmax ${dmax} line quadratic

# # Setup output
# thermo		1
# thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
# thermo_modify norm no

# COPIED FROM MODIFIED SCRIPT
#------------------------------------------------------
# Setup neighbor style
neighbor 3.0 nsq
neigh_modify once no every 1 delay 0 check yes
comm_modify cutoff 2.0

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

timestep	0.001


# Setup output
thermo		100
thermo_style custom step temp pe ebond eangle edihed press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.0001*${len0}
variable delta equal -0.0001*21.9724498695651
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.0001*xy
# variable deltaxz equal -${up}*xz
# variable deltayz equal -${up}*yz
if "${dir} == 1" then    "fix 42 all deform 1 x erate -${srate} units box remap x"    "run  ${nsteps}"
fix 42 all deform 1 x erate -${srate} units box remap x
fix 42 all deform 1 x erate -1e-05 units box remap x
run  ${nsteps}
run  2000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0
  ghost atom cutoff = 2
  0 neighbor lists, perpetual/occasional/extra = 0 0 0
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 11.75 | 11.75 | 11.75 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
       200   0              6.2020268e-08  6.2020268e-08  0              0             -0.0018255493  -0.33306444     0.3275878     -1.1616838e-10 -0.031468812   -5.2083673e-06  1.1110514e-05  21.97245       21.972448      1              482.78851    
       300   0              6.2251355e-08  6.2251355e-08  0              0              0.98717524     1.8823233      1.0792024      9.4316169e-11  0.0044463523  -4.1593868e-06  1.0500928e-05  21.972428      21.972448      1              482.78803    
       400   0              6.3155717e-08  6.3155717e-08  0              0              1.9861662      4.1200877      1.8384109      3.0692752e-10  0.040724426   -3.099808e-06   9.8851834e-06  21.972406      21.972448      1              482.78755    
       500   0              6.4734391e-08  6.4734391e-08  0              0              2.9851574      6.357851       2.5976212      5.1953955e-10  0.077002631   -2.0402268e-06  9.2694365e-06  21.972384      21.972448      1              482.78706    
       600   0              6.6987377e-08  6.6987377e-08  0              0              3.9841489      8.5956132      3.3568333      7.3215228e-10  0.11328097    -9.8064311e-07  8.6536877e-06  21.972362      21.972448      1              482.78658    
       700   0              6.9914673e-08  6.9914673e-08  0              0              4.9831406      10.833374      4.1160473      9.447657e-10   0.14955943     7.8943021e-08  8.0379371e-06  21.97234       21.972448      1              482.7861     
       800   0              7.3516281e-08  7.3516281e-08  0              0              5.9821325      13.071134      4.8752632      1.1573798e-09  0.18583803     1.1385316e-06  7.4221846e-06  21.972318      21.972448      1              482.78562    
       900   0              7.7792199e-08  7.7792199e-08  0              0              6.9811248      15.308893      5.6344808      1.3699946e-09  0.22211676     2.1981226e-06  6.8064302e-06  21.972296      21.972448      1              482.78513    
      1000   0              8.2742428e-08  8.2742428e-08  0              0              7.9801172      17.546651      6.3937003      1.5826101e-09  0.25839562     3.2577161e-06  6.1906739e-06  21.972274      21.972448      1              482.78465    
      1100   0              8.8366966e-08  8.8366966e-08  0              0              8.97911        19.784408      7.1529217      1.7952263e-09  0.29467461     4.3173121e-06  5.5749158e-06  21.972252      21.972448      1              482.78417    
      1200   0              9.4665814e-08  9.4665814e-08  0              0              9.9781029      22.022164      7.9121449      2.0078432e-09  0.33095373     5.3769105e-06  4.9591558e-06  21.97223       21.972448      1              482.78368    
      1300   0              1.0163897e-07  1.0163897e-07  0              0              10.977096      24.259919      8.6713699      2.2204607e-09  0.36723298     6.4365114e-06  4.3433939e-06  21.972208      21.972448      1              482.7832     
      1400   0              1.0928644e-07  1.0928644e-07  0              0              11.97609       26.497672      9.4305967      2.433079e-09   0.40351236     7.4961147e-06  3.7276301e-06  21.972186      21.972448      1              482.78272    
      1500   0              1.1760821e-07  1.1760821e-07  0              0              12.975083      28.735425      10.189825      2.6456979e-09  0.43979187     8.5557204e-06  3.1118644e-06  21.972164      21.972448      1              482.78224    
      1600   0              1.266043e-07   1.266043e-07   0              0              13.974077      30.973176      10.949056      2.8583176e-09  0.47607151     9.6153287e-06  2.4960969e-06  21.972142      21.972448      1              482.78175    
      1700   0              1.3627469e-07  1.3627469e-07  0              0              14.973072      33.210927      11.708288      3.0709379e-09  0.51235128     1.0674939e-05  1.8803275e-06  21.97212       21.972448      1              482.78127    
      1800   0              1.4661939e-07  1.4661939e-07  0              0              15.972066      35.448676      12.467522      3.2835589e-09  0.54863119     1.1734552e-05  1.2645562e-06  21.972098      21.972448      1              482.78079    
      1900   0              1.5763839e-07  1.5763839e-07  0              0              16.971061      37.686424      13.226759      3.4961806e-09  0.58491122     1.2794168e-05  6.487831e-07   21.972076      21.972448      1              482.78031    
      2000   0              1.6933171e-07  1.6933171e-07  0              0              17.970056      39.924171      13.985996      3.708803e-09   0.62119139     1.3853786e-05  3.3008062e-08  21.972054      21.972448      1              482.77982    
      2100   0              1.8169933e-07  1.8169933e-07  0              0              18.969051      42.161917      14.745236      3.9214261e-09  0.65747168     1.4913407e-05 -5.8276884e-07  21.972032      21.972448      1              482.77934    
      2200   0              1.9474125e-07  1.9474125e-07  0              0              19.968047      44.399662      15.504478      4.1340499e-09  0.69375211     1.597303e-05  -1.1985476e-06  21.97201       21.972448      1              482.77886    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.395371 on 1 procs for 2000 steps with 499 atoms

Performance: 437.058 ns/day, 0.055 hours/ns, 5058.539 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.33538    | 0.33538    | 0.33538    |   0.0 | 84.83
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.042442   | 0.042442   | 0.042442   |   0.0 | 10.73
Output  | 0.00021845 | 0.00021845 | 0.00021845 |   0.0 |  0.06
Modify  | 0.012085   | 0.012085   | 0.012085   |   0.0 |  3.06
Other   |            | 0.005249   |            |       |  1.33

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0
if "${dir} == 2" then    "fix 42 all deform 1 y erate -${srate} units box remap x"    "run  ${nsteps}"
# if "${dir} == 1" then #    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
# if "${dir} == 2" then #    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
# if "${dir} == 3" then #    "change_box all z delta 0 ${delta} remap units box"
# if "${dir} == 4" then #    "change_box all yz delta ${delta} remap units box"
# if "${dir} == 5" then #    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "fix 42 all deform 1 xy erate -${srate} units box remap x"    "run  ${nsteps}"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 200 ${maxeval}
minimize 0 1e-10 200 2000
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 12.88 | 12.88 | 12.88 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
      2200   0              1.9487508e-07  1.9487508e-07  0              0              19.978036      44.422039      15.51207       4.1361761e-09  0.69411491     1.5983626e-05 -1.2047054e-06  21.97201       21.972448      1              482.77886    
      2300   0              6.8274595e-10  6.8274595e-10  0              0              0.091010808    0.15076061     0.12227181     4.3597188e-11  0.2735449     -2.3847881e-07 -4.4898438e-08  21.97201       21.972448      1              482.77886    
      2400   0              1.7124845e-12  1.7124845e-12  0              0             -0.035315515   -0.038301909   -0.067644636   -8.5371998e-12  0.00094843066 -1.753977e-09   1.0608377e-08  21.97201       21.972448      1              482.77886    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.0977089 on 1 procs for 200 steps with 499 atoms

99.9% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
    1.94875076651117e-07 1.85285335122328e-12 1.71248446158021e-12
  Force two-norm initial, final = 0.0010175418 8.5002106e-07
  Force max component initial, final = 9.587817e-05 1.3200551e-07
  Final line search alpha, max atom move = 1 1.3200551e-07
  Iterations, force evaluations = 200 400

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.083041   | 0.083041   | 0.083041   |   0.0 | 84.99
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0085551  | 0.0085551  | 0.0085551  |   0.0 |  8.76
Output  | 4.4281e-05 | 4.4281e-05 | 4.4281e-05 |   0.0 |  0.05
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.006069   |            |       |  6.21

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0


# fix 69 all ave/time 1 $M $M v_pxx v_pyy v_pzz v_pxy v_pxz v_pyz
# Obtain new stress tensor
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.038301909364386
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.0676446362048282
# variable tmp equal pzz
# variable pzz1 equal ${tmp}
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 0.000948430656555726
# variable tmp equal pxz
# variable pxz1 equal ${tmp}
# variable tmp equal pyz
# variable pyz1 equal ${tmp}

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.0383449941079653
variable C2neg equal ${d2}
variable C2neg equal -0.0676535005819476
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
variable C6neg equal ${d6}
variable C6neg equal 0.000923231818673029

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style full from restart
  triclinic box = (-4.3478258e-07 4.9252223e-07 0) to (21.972449 21.972449 1) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  restoring bond style harmonic from restart
  restoring angle style harmonic from restart
  restoring dihedral style zero from restart
  499 atoms
  915 bonds
  3221 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.8333333333333334
     6 = max # of 1-2 neighbors
    21 = max # of 1-3 neighbors
    87 = max # of 1-4 neighbors
    32 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.002 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# EXAMPLE SCRIPT
#------------------------------------------------------
# # Choose potential
# pair_style	sw
# pair_coeff * * Si.sw Si

# # Setup neighbor style
# neighbor 1.0 nsq
# neigh_modify once no every 1 delay 0 check yes

# # Setup minimization style
# min_style	     cg
# min_modify	     dmax ${dmax} line quadratic

# # Setup output
# thermo		1
# thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
# thermo_modify norm no

# COPIED FROM MODIFIED SCRIPT
#------------------------------------------------------
# Setup neighbor style
neighbor 3.0 nsq
neigh_modify once no every 1 delay 0 check yes
comm_modify cutoff 2.0

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

timestep	0.001


# Setup output
thermo		100
thermo_style custom step temp pe ebond eangle edihed press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.0001*${len0}
variable delta equal 0.0001*21.9724498695651
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.0001*xy
# variable deltaxz equal ${up}*xz
# variable deltayz equal ${up}*yz
if "${dir} == 1" then    "fix 42 all deform 1 x erate ${srate} units box remap x"    "run  ${nsteps}"
fix 42 all deform 1 x erate ${srate} units box remap x
fix 42 all deform 1 x erate 1e-05 units box remap x
run  ${nsteps}
run  2000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0
  ghost atom cutoff = 2
  0 neighbor lists, perpetual/occasional/extra = 0 0 0
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 11.75 | 11.75 | 11.75 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
       200   0              6.2020268e-08  6.2020268e-08  0              0             -0.0018255493  -0.33306444     0.3275878     -1.1616838e-10 -0.031468812   -5.2083673e-06  1.1110514e-05  21.97245       21.972448      1              482.78851    
       300   0              6.2450075e-08  6.2450075e-08  0              0             -0.99082608    -2.5484532     -0.42402498    -3.2665225e-10 -0.067383847   -6.2573453e-06  1.1720098e-05  21.972472      21.972448      1              482.789      
       400   0              6.3555164e-08  6.3555164e-08  0              0             -1.9898163     -4.7862208     -1.183228      -5.3926154e-10 -0.10366153    -7.3169167e-06  1.2335837e-05  21.972494      21.972448      1              482.78948    
       500   0              6.5334566e-08  6.5334566e-08  0              0             -2.9888062     -7.0239894     -1.9424291     -7.5187013e-10 -0.13993908    -8.3764857e-06  1.2951575e-05  21.972516      21.972448      1              482.78996    
       600   0              6.7788282e-08  6.7788282e-08  0              0             -3.9877959     -9.2617591     -2.7016285     -9.6447804e-10 -0.17621651    -9.4360522e-06  1.356731e-05   21.972538      21.972448      1              482.79044    
       700   0              7.0916312e-08  7.0916312e-08  0              0             -4.9867853     -11.49953      -3.4608259     -1.1770852e-09 -0.2124938     -1.0495616e-05  1.4183044e-05  21.97256       21.972448      1              482.79093    
       800   0              7.4718656e-08  7.4718656e-08  0              0             -5.9857744     -13.737302     -4.2200216     -1.3896918e-09 -0.24877096    -1.1555178e-05  1.4798776e-05  21.972582      21.972448      1              482.79141    
       900   0              7.9195315e-08  7.9195315e-08  0              0             -6.9847634     -15.975075     -4.9792154     -1.6022976e-09 -0.28504799    -1.2614737e-05  1.5414506e-05  21.972604      21.972448      1              482.79189    
      1000   0              8.4346288e-08  8.4346288e-08  0              0             -7.983752      -18.212849     -5.7384074     -1.8149027e-09 -0.32132489    -1.3674294e-05  1.6030234e-05  21.972626      21.972448      1              482.79237    
      1100   0              9.0171576e-08  9.0171576e-08  0              0             -8.9827404     -20.450624     -6.4975975     -2.0275072e-09 -0.35760166    -1.4733848e-05  1.6645961e-05  21.972648      21.972448      1              482.79286    
      1200   0              9.667118e-08   9.667118e-08   0              0             -9.9817286     -22.6884       -7.2567858     -2.240111e-09  -0.39387829    -1.57934e-05    1.7261685e-05  21.97267       21.972448      1              482.79334    
      1300   0              1.038451e-07   1.038451e-07   0              0             -10.980716     -24.926177     -8.0159723     -2.452714e-09  -0.4301548     -1.6852949e-05  1.7877407e-05  21.972692      21.972448      1              482.79382    
      1400   0              1.1169334e-07  1.1169334e-07  0              0             -11.979704     -27.163955     -8.7751569     -2.6653164e-09 -0.46643118    -1.7912496e-05  1.8493128e-05  21.972714      21.972448      1              482.79431    
      1500   0              1.2021589e-07  1.2021589e-07  0              0             -12.978692     -29.401735     -9.5343397     -2.8779181e-09 -0.50270742    -1.897204e-05   1.9108847e-05  21.972736      21.972448      1              482.79479    
      1600   0              1.2941276e-07  1.2941276e-07  0              0             -13.977679     -31.639515     -10.293521     -3.0905191e-09 -0.53898354    -2.0031582e-05  1.9724564e-05  21.972757      21.972448      1              482.79527    
      1700   0              1.3928394e-07  1.3928394e-07  0              0             -14.976666     -33.877297     -11.0527       -3.3031194e-09 -0.57525952    -2.1091122e-05  2.0340279e-05  21.972779      21.972448      1              482.79575    
      1800   0              1.4982945e-07  1.4982945e-07  0              0             -15.975652     -36.115079     -11.811877     -3.515719e-09  -0.61153538    -2.2150659e-05  2.0955992e-05  21.972801      21.972448      1              482.79624    
      1900   0              1.6104927e-07  1.6104927e-07  0              0             -16.974639     -38.352863     -12.571053     -3.7283179e-09 -0.6478111     -2.3210193e-05  2.1571703e-05  21.972823      21.972448      1              482.79672    
      2000   0              1.7294341e-07  1.7294341e-07  0              0             -17.973625     -40.590648     -13.330226     -3.9409162e-09 -0.68408669    -2.4269725e-05  2.2187413e-05  21.972845      21.972448      1              482.7972     
      2100   0              1.8551186e-07  1.8551186e-07  0              0             -18.972611     -42.828434     -14.089398     -4.1535137e-09 -0.72036215    -2.5329255e-05  2.280312e-05   21.972867      21.972448      1              482.79769    
      2200   0              1.9875464e-07  1.9875464e-07  0              0             -19.971596     -45.066221     -14.848568     -4.3661106e-09 -0.75663749    -2.6388782e-05  2.3418826e-05  21.972889      21.972448      1              482.79817    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.398277 on 1 procs for 2000 steps with 499 atoms

Performance: 433.869 ns/day, 0.055 hours/ns, 5021.627 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.33838    | 0.33838    | 0.33838    |   0.0 | 84.96
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.042081   | 0.042081   | 0.042081   |   0.0 | 10.57
Output  | 0.00025267 | 0.00025267 | 0.00025267 |   0.0 |  0.06
Modify  | 0.012313   | 0.012313   | 0.012313   |   0.0 |  3.09
Other   |            | 0.005247   |            |       |  1.32

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0
if "${dir} == 2" then    "fix 42 all deform 1 y erate ${srate} units box remap x"    "run  ${nsteps}"
# if "${dir} == 1" then #    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
# if "${dir} == 2" then #    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
# if "${dir} == 3" then #    "change_box all z delta 0 ${delta} remap units box"
# if "${dir} == 4" then #    "change_box all yz delta ${delta} remap units box"
# if "${dir} == 5" then #    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "fix 42 all deform 1 xy erate ${srate} units box remap x"    "run  ${nsteps}"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 200 ${maxeval}
minimize 0 1e-10 200 2000
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 12.88 | 12.88 | 12.88 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
      2200   0              1.9889047e-07  1.9889047e-07  0              0             -19.981586     -45.088599     -14.85616      -4.3682366e-09 -0.75700025    -2.6399378e-05  2.3424983e-05  21.972889      21.972448      1              482.79817    
      2300   0              7.0789869e-10  7.0789869e-10  0              0             -0.21458568    -0.30870156    -0.33505547    -5.9977817e-11 -0.31771759     1.7280913e-07  3.6638323e-07  21.972889      21.972448      1              482.79817    
      2400   0              1.8158695e-12  1.8158695e-12  0              0             -0.019698753   -0.043182003   -0.015914256   -4.1922603e-12 -0.0056654363  -2.1849212e-10 -1.6420822e-08  21.972889      21.972448      1              482.79817    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.0956119 on 1 procs for 200 steps with 499 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
    1.98890473516009e-07 1.94832816638988e-12 1.81586950718462e-12
  Force two-norm initial, final = 0.0010692782 8.5350047e-07
  Force max component initial, final = 9.8518689e-05 1.3305952e-07
  Final line search alpha, max atom move = 1 1.3305952e-07
  Iterations, force evaluations = 200 400

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.08127    | 0.08127    | 0.08127    |   0.0 | 85.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0083638  | 0.0083638  | 0.0083638  |   0.0 |  8.75
Output  | 2.8475e-05 | 2.8475e-05 | 2.8475e-05 |   0.0 |  0.03
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.00595    |            |       |  6.22

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0


# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal 1.81586950718462e-12
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -0.0196987530241298
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.0431820030205127
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.0159142560476844
# variable tmp equal pzz
# variable pzz1 equal ${tmp}
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -0.00566543625423551
# variable tmp equal pxz
# variable pxz1 equal ${tmp}
# variable tmp equal pyz
# variable pyz1 equal ${tmp}

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.043225087764092
variable C2pos equal ${d2}
variable C2pos equal 0.0159231204248038
# variable C3pos equal ${d3}
# variable C4pos equal ${d4}
# variable C5pos equal ${d5}
variable C6pos equal ${d6}
variable C6pos equal 0.00569063509211821

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-0.0383449941079653+${C1pos})
variable C11 equal 0.5*(-0.0383449941079653+0.043225087764092)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-0.0676535005819476+${C2pos})
variable C21 equal 0.5*(-0.0676535005819476+0.0159231204248038)
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(0.000923231818673029+${C6pos})
variable C61 equal 0.5*(0.000923231818673029+0.00569063509211821)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

variable dt equal 0.005
variable strain equal 1e-4
variable srate equal 1e-5
variable M equal 1000 # averaging time for properties
timestep ${dt}
timestep 0.005
variable strainsteps equal ${strain}/${dt}/${srate}
variable strainsteps equal 0.0001/${dt}/${srate}
variable strainsteps equal 0.0001/0.005/${srate}
variable strainsteps equal 0.0001/0.005/1e-05
variable nsteps equal round(${strainsteps})
variable nsteps equal round(2000)
print "nsteps ${nsteps}"
nsteps 2000

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 21.9724480149555
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style full from restart
  triclinic box = (-4.3478258e-07 4.9252223e-07 0) to (21.972449 21.972449 1) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  restoring bond style harmonic from restart
  restoring angle style harmonic from restart
  restoring dihedral style zero from restart
  499 atoms
  915 bonds
  3221 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.8333333333333334
     6 = max # of 1-2 neighbors
    21 = max # of 1-3 neighbors
    87 = max # of 1-4 neighbors
    32 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.002 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# EXAMPLE SCRIPT
#------------------------------------------------------
# # Choose potential
# pair_style	sw
# pair_coeff * * Si.sw Si

# # Setup neighbor style
# neighbor 1.0 nsq
# neigh_modify once no every 1 delay 0 check yes

# # Setup minimization style
# min_style	     cg
# min_modify	     dmax ${dmax} line quadratic

# # Setup output
# thermo		1
# thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
# thermo_modify norm no

# COPIED FROM MODIFIED SCRIPT
#------------------------------------------------------
# Setup neighbor style
neighbor 3.0 nsq
neigh_modify once no every 1 delay 0 check yes
comm_modify cutoff 2.0

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

timestep	0.001


# Setup output
thermo		100
thermo_style custom step temp pe ebond eangle edihed press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.0001*${len0}
variable delta equal -0.0001*21.9724480149555
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.0001*xy
# variable deltaxz equal -${up}*xz
# variable deltayz equal -${up}*yz
if "${dir} == 1" then    "fix 42 all deform 1 x erate -${srate} units box remap x"    "run  ${nsteps}"
if "${dir} == 2" then    "fix 42 all deform 1 y erate -${srate} units box remap x"    "run  ${nsteps}"
fix 42 all deform 1 y erate -${srate} units box remap x
fix 42 all deform 1 y erate -1e-05 units box remap x
run  ${nsteps}
run  2000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0
  ghost atom cutoff = 2
  0 neighbor lists, perpetual/occasional/extra = 0 0 0
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 11.75 | 11.75 | 11.75 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
       200   0              6.2020268e-08  6.2020268e-08  0              0             -0.0018255493  -0.33306444     0.3275878     -1.1616838e-10 -0.031468812   -5.2083673e-06  1.1110514e-05  21.97245       21.972448      1              482.78851    
       300   0              6.2460117e-08  6.2460117e-08  0              0              1.0132696      0.41854955     2.6212593      1.0110011e-10 -0.0049366229  -5.6185188e-06  1.0825463e-05  21.97245       21.972426      1              482.78803    
       400   0              6.3599059e-08  6.3599059e-08  0              0              2.0386185      1.1777576      4.9380979      3.2056395e-10  0.021863679   -6.0328144e-06  1.0537534e-05  21.97245       21.972404      1              482.78755    
       500   0              6.543614e-08   6.543614e-08   0              0              3.0639676      1.9369675      7.2549354      5.4002851e-10  0.048664093   -6.4471115e-06  1.0249604e-05  21.97245       21.972382      1              482.78706    
       600   0              6.797136e-08   6.797136e-08   0              0              4.089317       2.6961794      9.5717717      7.5949379e-10  0.075464619   -6.8614098e-06  9.9616738e-06  21.97245       21.97236       1              482.78658    
       700   0              7.120472e-08   7.120472e-08   0              0              5.1146667      3.4553933      11.888607      9.7895978e-10  0.10226526    -7.2757094e-06  9.6737439e-06  21.97245       21.972338      1              482.7861     
       800   0              7.5136217e-08  7.5136217e-08  0              0              6.1400166      4.2146092      14.205441      1.1984265e-09  0.12906601    -7.6900104e-06  9.385814e-06   21.97245       21.972316      1              482.78562    
       900   0              7.9765853e-08  7.9765853e-08  0              0              7.1653668      4.973827       16.522273      1.4178939e-09  0.15586687    -8.1043127e-06  9.0978842e-06  21.97245       21.972294      1              482.78513    
      1000   0              8.5093627e-08  8.5093627e-08  0              0              8.1907172      5.7330467      18.839105      1.6373621e-09  0.18266784    -8.5186163e-06  8.8099544e-06  21.97245       21.972272      1              482.78465    
      1100   0              9.1119537e-08  9.1119537e-08  0              0              9.2160678      6.4922685      21.155935      1.8568309e-09  0.20946893    -8.9329212e-06  8.5220245e-06  21.97245       21.97225       1              482.78417    
      1200   0              9.7843585e-08  9.7843585e-08  0              0              10.241419      7.2514921      23.472764      2.0763005e-09  0.23627012    -9.3472275e-06  8.2340947e-06  21.97245       21.972228      1              482.78368    
      1300   0              1.0526577e-07  1.0526577e-07  0              0              11.26677       8.0107178      25.789592      2.2957708e-09  0.26307143    -9.761535e-06   7.9461649e-06  21.97245       21.972206      1              482.7832     
      1400   0              1.1338609e-07  1.1338609e-07  0              0              12.292121      8.7699454      28.106419      2.5152419e-09  0.28987285    -1.0175844e-05  7.6582351e-06  21.97245       21.972184      1              482.78272    
      1500   0              1.2220455e-07  1.2220455e-07  0              0              13.317473      9.5291749      30.423244      2.7347136e-09  0.31667438    -1.0590154e-05  7.3703053e-06  21.97245       21.972162      1              482.78224    
      1600   0              1.3172114e-07  1.3172114e-07  0              0              14.342825      10.288406      32.740068      2.9541861e-09  0.34347603    -1.1004466e-05  7.0823755e-06  21.97245       21.97214       1              482.78175    
      1700   0              1.4193587e-07  1.4193587e-07  0              0              15.368177      11.04764       35.056891      3.1736592e-09  0.37027778    -1.1418778e-05  6.7944458e-06  21.97245       21.972118      1              482.78127    
      1800   0              1.5284873e-07  1.5284873e-07  0              0              16.39353       11.806875      37.373713      3.3931331e-09  0.39707965    -1.1833093e-05  6.506516e-06   21.97245       21.972096      1              482.78079    
      1900   0              1.6445973e-07  1.6445973e-07  0              0              17.418882      12.566113      39.690534      3.6126077e-09  0.42388163    -1.2247408e-05  6.2185863e-06  21.97245       21.972074      1              482.78031    
      2000   0              1.7676886e-07  1.7676886e-07  0              0              18.444235      13.325352      42.007353      3.8320831e-09  0.45068372    -1.2661725e-05  5.9306566e-06  21.97245       21.972053      1              482.77982    
      2100   0              1.8977612e-07  1.8977612e-07  0              0              19.469588      14.084593      44.324172      4.0515591e-09  0.47748592    -1.3076043e-05  5.6427269e-06  21.97245       21.972031      1              482.77934    
      2200   0              2.0348152e-07  2.0348152e-07  0              0              20.494942      14.843837      46.640989      4.2710359e-09  0.50428823    -1.3490362e-05  5.3547972e-06  21.97245       21.972009      1              482.77886    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.404256 on 1 procs for 2000 steps with 499 atoms

Performance: 427.452 ns/day, 0.056 hours/ns, 4947.359 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.3437     | 0.3437     | 0.3437     |   0.0 | 85.02
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.042422   | 0.042422   | 0.042422   |   0.0 | 10.49
Output  | 0.00027481 | 0.00027481 | 0.00027481 |   0.0 |  0.07
Modify  | 0.012466   | 0.012466   | 0.012466   |   0.0 |  3.08
Other   |            | 0.005396   |            |       |  1.33

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0
# if "${dir} == 1" then #    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
# if "${dir} == 2" then #    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
# if "${dir} == 3" then #    "change_box all z delta 0 ${delta} remap units box"
# if "${dir} == 4" then #    "change_box all yz delta ${delta} remap units box"
# if "${dir} == 5" then #    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "fix 42 all deform 1 xy erate -${srate} units box remap x"    "run  ${nsteps}"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 200 ${maxeval}
minimize 0 1e-10 200 2000
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 12.88 | 12.88 | 12.88 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
      2200   0              2.036221e-07   2.036221e-07   0              0              20.505195      14.851429      46.664157      4.2732306e-09  0.50455625    -1.3494506e-05  5.3519178e-06  21.97245       21.972009      1              482.77886    
      2300   0              2.6236134e-09  2.6236134e-09  0              0              0.78822777     1.5752579      0.78942538     1.8772204e-10  0.32066891     1.4462062e-07  4.6880627e-07  21.97245       21.972009      1              482.77886    
      2400   0              2.3269268e-12  2.3269268e-12  0              0             -0.032203505   -0.059249173   -0.03736134    -7.9810906e-12  0.009179609    9.4441793e-09  1.3233183e-08  21.97245       21.972009      1              482.77886    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.0964649 on 1 procs for 200 steps with 499 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
    2.03622101302487e-07 2.52731576650338e-12 2.32692677224042e-12
  Force two-norm initial, final = 0.001039024 9.8553838e-07
  Force max component initial, final = 0.00011780389 1.1957478e-07
  Final line search alpha, max atom move = 1 1.1957478e-07
  Iterations, force evaluations = 200 400

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.082028   | 0.082028   | 0.082028   |   0.0 | 85.03
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0083916  | 0.0083916  | 0.0083916  |   0.0 |  8.70
Output  | 4.1778e-05 | 4.1778e-05 | 4.1778e-05 |   0.0 |  0.04
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.006004   |            |       |  6.22

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0


# fix 69 all ave/time 1 $M $M v_pxx v_pyy v_pzz v_pxy v_pxz v_pyz
# Obtain new stress tensor
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.0592491734299241
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.0373613403024932
# variable tmp equal pzz
# variable pzz1 equal ${tmp}
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 0.00917960896170583
# variable tmp equal pxz
# variable pxz1 equal ${tmp}
# variable tmp equal pyz
# variable pyz1 equal ${tmp}

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.0592922581735034
variable C2neg equal ${d2}
variable C2neg equal -0.0373702046796126
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
variable C6neg equal ${d6}
variable C6neg equal 0.00915441012382313

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style full from restart
  triclinic box = (-4.3478258e-07 4.9252223e-07 0) to (21.972449 21.972449 1) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  restoring bond style harmonic from restart
  restoring angle style harmonic from restart
  restoring dihedral style zero from restart
  499 atoms
  915 bonds
  3221 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.8333333333333334
     6 = max # of 1-2 neighbors
    21 = max # of 1-3 neighbors
    87 = max # of 1-4 neighbors
    32 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.002 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# EXAMPLE SCRIPT
#------------------------------------------------------
# # Choose potential
# pair_style	sw
# pair_coeff * * Si.sw Si

# # Setup neighbor style
# neighbor 1.0 nsq
# neigh_modify once no every 1 delay 0 check yes

# # Setup minimization style
# min_style	     cg
# min_modify	     dmax ${dmax} line quadratic

# # Setup output
# thermo		1
# thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
# thermo_modify norm no

# COPIED FROM MODIFIED SCRIPT
#------------------------------------------------------
# Setup neighbor style
neighbor 3.0 nsq
neigh_modify once no every 1 delay 0 check yes
comm_modify cutoff 2.0

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

timestep	0.001


# Setup output
thermo		100
thermo_style custom step temp pe ebond eangle edihed press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.0001*${len0}
variable delta equal 0.0001*21.9724480149555
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.0001*xy
# variable deltaxz equal ${up}*xz
# variable deltayz equal ${up}*yz
if "${dir} == 1" then    "fix 42 all deform 1 x erate ${srate} units box remap x"    "run  ${nsteps}"
if "${dir} == 2" then    "fix 42 all deform 1 y erate ${srate} units box remap x"    "run  ${nsteps}"
fix 42 all deform 1 y erate ${srate} units box remap x
fix 42 all deform 1 y erate 1e-05 units box remap x
run  ${nsteps}
run  2000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0
  ghost atom cutoff = 2
  0 neighbor lists, perpetual/occasional/extra = 0 0 0
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 11.75 | 11.75 | 11.75 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
       200   0              6.2020268e-08  6.2020268e-08  0              0             -0.0018255493  -0.33306444     0.3275878     -1.1616838e-10 -0.031468812   -5.2083673e-06  1.1110514e-05  21.97245       21.972448      1              482.78851    
       300   0              6.2264666e-08  6.2264666e-08  0              0             -1.0169204     -1.0846765     -1.9660848     -3.3343617e-10 -0.058000891   -4.7982171e-06  1.1395565e-05  21.97245       21.97247       1              482.789      
       400   0              6.3206182e-08  6.3206182e-08  0              0             -2.0422686     -1.8438787     -4.282927      -5.5289787e-10 -0.084800861   -4.3839253e-06  1.1683495e-05  21.97245       21.972492      1              482.78948    
       500   0              6.484584e-08   6.484584e-08   0              0             -3.0676164     -2.6030788     -6.5997704     -7.7235884e-10 -0.11160072    -3.9696349e-06  1.1971424e-05  21.97245       21.972514      1              482.78996    
       600   0              6.7183639e-08  6.7183639e-08  0              0             -4.092964      -3.3622771     -8.916615      -9.918191e-10  -0.13840046    -3.5553458e-06  1.2259354e-05  21.97245       21.972536      1              482.79044    
       700   0              7.0219579e-08  7.0219579e-08  0              0             -5.1183114     -4.1214733     -11.233461     -1.2112786e-09 -0.1652001     -3.141058e-06   1.2547284e-05  21.97245       21.972558      1              482.79093    
       800   0              7.3953662e-08  7.3953662e-08  0              0             -6.1436585     -4.8806677     -13.550308     -1.4307375e-09 -0.19199962    -2.7267716e-06  1.2835214e-05  21.97245       21.97258       1              482.79141    
       900   0              7.8385887e-08  7.8385887e-08  0              0             -7.1690053     -5.63986       -15.867156     -1.6501956e-09 -0.21879903    -2.3124864e-06  1.3123144e-05  21.97245       21.972602      1              482.79189    
      1000   0              8.3516255e-08  8.3516255e-08  0              0             -8.1943519     -6.3990504     -18.184005     -1.869653e-09  -0.24559833    -1.8982026e-06  1.3411074e-05  21.97245       21.972624      1              482.79237    
      1100   0              8.9344766e-08  8.9344766e-08  0              0             -9.2196983     -7.1582388     -20.500856     -2.0891096e-09 -0.27239751    -1.4839201e-06  1.3699004e-05  21.97245       21.972646      1              482.79286    
      1200   0              9.587142e-08   9.587142e-08   0              0             -10.245044     -7.9174253     -22.817708     -2.3085656e-09 -0.29919659    -1.0696389e-06  1.3986934e-05  21.97245       21.972668      1              482.79334    
      1300   0              1.0309622e-07  1.0309622e-07  0              0             -11.27039      -8.6766098     -25.134561     -2.5280208e-09 -0.32599555    -6.5535899e-07  1.4274865e-05  21.97245       21.97269       1              482.79382    
      1400   0              1.1101916e-07  1.1101916e-07  0              0             -12.295736     -9.4357924     -27.451415     -2.7474753e-09 -0.35279441    -2.4108045e-07  1.4562795e-05  21.97245       21.972712      1              482.79431    
      1500   0              1.1964025e-07  1.1964025e-07  0              0             -13.321081     -10.194973     -29.76827      -2.9669291e-09 -0.37959314     1.7319679e-07  1.4850725e-05  21.97245       21.972734      1              482.79479    
      1600   0              1.2895948e-07  1.2895948e-07  0              0             -14.346426     -10.954152     -32.085127     -3.1863822e-09 -0.40639177     5.8747269e-07  1.5138655e-05  21.97245       21.972756      1              482.79527    
      1700   0              1.3897686e-07  1.3897686e-07  0              0             -15.371771     -11.713328     -34.401985     -3.4058346e-09 -0.43319029     1.0017473e-06  1.5426585e-05  21.97245       21.972778      1              482.79575    
      1800   0              1.4969238e-07  1.4969238e-07  0              0             -16.397116     -12.472503     -36.718844     -3.6252862e-09 -0.45998869     1.4160205e-06  1.5714515e-05  21.97245       21.9728        1              482.79624    
      1900   0              1.6110605e-07  1.6110605e-07  0              0             -17.42246      -13.231676     -39.035704     -3.8447371e-09 -0.48678698     1.8302925e-06  1.6002445e-05  21.97245       21.972822      1              482.79672    
      2000   0              1.7321787e-07  1.7321787e-07  0              0             -18.447804     -13.990847     -41.352565     -4.0641874e-09 -0.51358516     2.2445631e-06  1.6290375e-05  21.97245       21.972844      1              482.7972     
      2100   0              1.8602783e-07  1.8602783e-07  0              0             -19.473148     -14.750015     -43.669428     -4.2836368e-09 -0.54038323     2.6588324e-06  1.6578305e-05  21.97245       21.972865      1              482.79769    
      2200   0              1.9953594e-07  1.9953594e-07  0              0             -20.498491     -15.509182     -45.986292     -4.5030856e-09 -0.56718119     3.0731004e-06  1.6866235e-05  21.97245       21.972887      1              482.79817    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.405127 on 1 procs for 2000 steps with 499 atoms

Performance: 426.533 ns/day, 0.056 hours/ns, 4936.719 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.34368    | 0.34368    | 0.34368    |   0.0 | 84.83
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.043133   | 0.043133   | 0.043133   |   0.0 | 10.65
Output  | 0.00035484 | 0.00035484 | 0.00035484 |   0.0 |  0.09
Modify  | 0.012538   | 0.012538   | 0.012538   |   0.0 |  3.09
Other   |            | 0.005422   |            |       |  1.34

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0
# if "${dir} == 1" then #    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
# if "${dir} == 2" then #    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
# if "${dir} == 3" then #    "change_box all z delta 0 ${delta} remap units box"
# if "${dir} == 4" then #    "change_box all yz delta ${delta} remap units box"
# if "${dir} == 5" then #    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "fix 42 all deform 1 xy erate ${srate} units box remap x"    "run  ${nsteps}"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 200 ${maxeval}
minimize 0 1e-10 200 2000
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 12.88 | 12.88 | 12.88 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
      2200   0              1.9967455e-07  1.9967455e-07  0              0             -20.508745     -15.516774     -46.009461     -4.5052801e-09 -0.56744918     3.0772431e-06  1.6869115e-05  21.97245       21.972887      1              482.79817    
      2300   0              2.717249e-09   2.717249e-09   0              0             -0.92217233    -1.7914707     -0.97504631    -1.815918e-10  -0.34068685    -1.8170967e-08 -1.1774181e-07  21.97245       21.972887      1              482.79817    
      2400   0              2.4008035e-12  2.4008035e-12  0              0             -0.019899252   -0.018052322   -0.041645434   -4.3155267e-12 -0.013885038    2.0250691e-08  2.015549e-08   21.97245       21.972887      1              482.79817    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.0952223 on 1 procs for 200 steps with 499 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
    1.99674546362509e-07 2.5835392584527e-12 2.40080350965364e-12
  Force two-norm initial, final = 0.0010325077 9.8055281e-07
  Force max component initial, final = 0.00010943508 1.5926911e-07
  Final line search alpha, max atom move = 1 1.5926911e-07
  Iterations, force evaluations = 200 400

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.080995   | 0.080995   | 0.080995   |   0.0 | 85.06
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0083457  | 0.0083457  | 0.0083457  |   0.0 |  8.76
Output  | 2.0963e-05 | 2.0963e-05 | 2.0963e-05 |   0.0 |  0.02
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.005861   |            |       |  6.16

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0


# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal 2.40080350965364e-12
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -0.0198992522399388
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.0180523222268598
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.0416454344886411
# variable tmp equal pzz
# variable pzz1 equal ${tmp}
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -0.0138850375897126
# variable tmp equal pxz
# variable pxz1 equal ${tmp}
# variable tmp equal pyz
# variable pyz1 equal ${tmp}

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.0180954069704391
variable C2pos equal ${d2}
variable C2pos equal 0.0416542988657605
# variable C3pos equal ${d3}
# variable C4pos equal ${d4}
# variable C5pos equal ${d5}
variable C6pos equal ${d6}
variable C6pos equal 0.0139102364275953

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-0.0592922581735034+${C1pos})
variable C12 equal 0.5*(-0.0592922581735034+0.0180954069704391)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-0.0373702046796126+${C2pos})
variable C22 equal 0.5*(-0.0373702046796126+0.0416542988657605)
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.00915441012382313+${C6pos})
variable C62 equal 0.5*(0.00915441012382313+0.0139102364275953)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

# variable dir equal 3
# include displace.mod

# uyz Perturbation

# variable dir equal 4
# include displace.mod

# uxz Perturbation

# variable dir equal 5
# include displace.mod

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

variable dt equal 0.005
variable strain equal 1e-4
variable srate equal 1e-5
variable M equal 1000 # averaging time for properties
timestep ${dt}
timestep 0.005
variable strainsteps equal ${strain}/${dt}/${srate}
variable strainsteps equal 0.0001/${dt}/${srate}
variable strainsteps equal 0.0001/0.005/${srate}
variable strainsteps equal 0.0001/0.005/1e-05
variable nsteps equal round(${strainsteps})
variable nsteps equal round(2000)
print "nsteps ${nsteps}"
nsteps 2000

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 21.9724480149555

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style full from restart
  triclinic box = (-4.3478258e-07 4.9252223e-07 0) to (21.972449 21.972449 1) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  restoring bond style harmonic from restart
  restoring angle style harmonic from restart
  restoring dihedral style zero from restart
  499 atoms
  915 bonds
  3221 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.8333333333333334
     6 = max # of 1-2 neighbors
    21 = max # of 1-3 neighbors
    87 = max # of 1-4 neighbors
    32 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.002 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# EXAMPLE SCRIPT
#------------------------------------------------------
# # Choose potential
# pair_style	sw
# pair_coeff * * Si.sw Si

# # Setup neighbor style
# neighbor 1.0 nsq
# neigh_modify once no every 1 delay 0 check yes

# # Setup minimization style
# min_style	     cg
# min_modify	     dmax ${dmax} line quadratic

# # Setup output
# thermo		1
# thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
# thermo_modify norm no

# COPIED FROM MODIFIED SCRIPT
#------------------------------------------------------
# Setup neighbor style
neighbor 3.0 nsq
neigh_modify once no every 1 delay 0 check yes
comm_modify cutoff 2.0

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

timestep	0.001


# Setup output
thermo		100
thermo_style custom step temp pe ebond eangle edihed press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.0001*${len0}
variable delta equal -0.0001*21.9724480149555
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.0001*xy
# variable deltaxz equal -${up}*xz
# variable deltayz equal -${up}*yz
if "${dir} == 1" then    "fix 42 all deform 1 x erate -${srate} units box remap x"    "run  ${nsteps}"
if "${dir} == 2" then    "fix 42 all deform 1 y erate -${srate} units box remap x"    "run  ${nsteps}"
# if "${dir} == 1" then #    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
# if "${dir} == 2" then #    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
# if "${dir} == 3" then #    "change_box all z delta 0 ${delta} remap units box"
# if "${dir} == 4" then #    "change_box all yz delta ${delta} remap units box"
# if "${dir} == 5" then #    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "fix 42 all deform 1 xy erate -${srate} units box remap x"    "run  ${nsteps}"
fix 42 all deform 1 xy erate -${srate} units box remap x
fix 42 all deform 1 xy erate -1e-05 units box remap x
run  ${nsteps}
run  2000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0
  ghost atom cutoff = 2
  0 neighbor lists, perpetual/occasional/extra = 0 0 0
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 11.77 | 11.77 | 11.77 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
       200   0              6.2020268e-08  6.2020268e-08  0              0             -0.0018255493  -0.33306444     0.3275878     -1.1616838e-10 -0.031468812   -5.2083673e-06  1.1110514e-05  21.97245       21.972448      1              482.78851    
       300   0              6.2122991e-08  6.2122991e-08  0              0              0.018989589   -0.29715062     0.35411938    -9.9535153e-11  0.72014415    -5.8179737e-06  1.0700368e-05  21.97245       21.972448      1              482.78851    
       400   0              6.2454381e-08  6.2454381e-08  0              0              0.04001371    -0.26087672     0.38091785    -8.2733971e-11  1.479349      -6.4337367e-06  1.0286079e-05  21.97245       21.972448      1              482.78851    
       500   0              6.3014544e-08  6.3014544e-08  0              0              0.061036553   -0.22460555     0.40771521    -6.5932848e-11  2.2385538     -7.0494989e-06  9.8717901e-06  21.97245       21.972448      1              482.78851    
       600   0              6.380348e-08   6.380348e-08   0              0              0.082058117   -0.1883371      0.43451145    -4.9131785e-11  2.9977584     -7.6652601e-06  9.4575006e-06  21.97245       21.972448      1              482.78851    
       700   0              6.482119e-08   6.482119e-08   0              0              0.1030784     -0.15207136     0.46130657    -3.2330781e-11  3.7569628     -8.2810205e-06  9.0432107e-06  21.97245       21.972448      1              482.78851    
       800   0              6.6067673e-08  6.6067673e-08  0              0              0.12409741    -0.11580835     0.48810057    -1.5529837e-11  4.5161672     -8.8967799e-06  8.6289206e-06  21.97245       21.972448      1              482.78851    
       900   0              6.754293e-08   6.754293e-08   0              0              0.14511514    -0.079548048    0.51489346     1.2710462e-12  5.2753713     -9.5125385e-06  8.2146302e-06  21.97245       21.972448      1              482.78851    
      1000   0              6.924696e-08   6.924696e-08   0              0              0.16613159    -0.04329047     0.54168523     1.8071871e-11  6.0345754     -1.0128296e-05  7.8003394e-06  21.97245       21.972448      1              482.78851    
      1100   0              7.1179762e-08  7.1179762e-08  0              0              0.18714676    -0.0070356075   0.56847589     3.4872635e-11  6.7937793     -1.0744053e-05  7.3860484e-06  21.97245       21.972448      1              482.78851    
      1200   0              7.3341338e-08  7.3341338e-08  0              0              0.20816065     0.029216534    0.59526543     5.167334e-11   7.5529831     -1.1359809e-05  6.9717571e-06  21.97245       21.972448      1              482.78851    
      1300   0              7.5731687e-08  7.5731687e-08  0              0              0.22917327     0.065465958    0.62205385     6.8473985e-11  8.3121867     -1.1975564e-05  6.5574655e-06  21.97245       21.972448      1              482.78851    
      1400   0              7.8350809e-08  7.8350809e-08  0              0              0.2501846      0.10171266     0.64884115     8.5274571e-11  9.0713902     -1.2591318e-05  6.1431736e-06  21.97245       21.972448      1              482.78851    
      1500   0              8.1198704e-08  8.1198704e-08  0              0              0.27119466     0.13795665     0.67562734     1.020751e-10   9.8305935     -1.3207071e-05  5.7288813e-06  21.97245       21.972448      1              482.78851    
      1600   0              8.4275372e-08  8.4275372e-08  0              0              0.29220344     0.17419792     0.70241241     1.1887556e-10  10.589797     -1.3822823e-05  5.3145888e-06  21.97245       21.972448      1              482.78851    
      1700   0              8.7580813e-08  8.7580813e-08  0              0              0.31321094     0.21043647     0.72919637     1.3567597e-10  11.349        -1.4438574e-05  4.900296e-06   21.97245       21.972448      1              482.78851    
      1800   0              9.1115026e-08  9.1115026e-08  0              0              0.33421717     0.2466723      0.7559792      1.5247632e-10  12.108203     -1.5054325e-05  4.4860029e-06  21.97245       21.972448      1              482.78851    
      1900   0              9.4878013e-08  9.4878013e-08  0              0              0.35522211     0.28290541     0.78276093     1.692766e-10   12.867406     -1.5670074e-05  4.0717095e-06  21.97245       21.972448      1              482.78851    
      2000   0              9.8869772e-08  9.8869772e-08  0              0              0.37622578     0.3191358      0.80954153     1.8607683e-10  13.626608     -1.6285823e-05  3.6574158e-06  21.97245       21.972448      1              482.78851    
      2100   0              1.030903e-07   1.030903e-07   0              0              0.39722817     0.35536348     0.83632102     2.02877e-10    14.385811     -1.690157e-05   3.2431218e-06  21.97245       21.972448      1              482.78851    
      2200   0              1.0753961e-07  1.0753961e-07  0              0              0.41822927     0.39158843     0.86309939     2.1967711e-10  15.145013     -1.7517317e-05  2.8288274e-06  21.97245       21.972448      1              482.78851    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.400003 on 1 procs for 2000 steps with 499 atoms

Performance: 431.997 ns/day, 0.056 hours/ns, 4999.961 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.33981    | 0.33981    | 0.33981    |   0.0 | 84.95
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.042391   | 0.042391   | 0.042391   |   0.0 | 10.60
Output  | 0.00023967 | 0.00023967 | 0.00023967 |   0.0 |  0.06
Modify  | 0.012274   | 0.012274   | 0.012274   |   0.0 |  3.07
Other   |            | 0.005293   |            |       |  1.32

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 200 ${maxeval}
minimize 0 1e-10 200 2000
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 12.9 | 12.9 | 12.9 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
      2200   0              1.0758526e-07  1.0758526e-07  0              0              0.41843928     0.39195067     0.86336717     2.1984511e-10  15.152605     -1.7523475e-05  2.8246845e-06  21.97245       21.972448      1              482.78851    
      2300   0              4.8620412e-11  4.8620412e-11  0              0              0.30558241     0.49017147     0.42657574     6.8405428e-11  0.014912628   -2.6571201e-08 -1.2252234e-08  21.97245       21.972448      1              482.78851    
      2400   0              6.2356253e-13  6.2356253e-13  0              0              0.014833034    0.015680985    0.028818118    3.1486398e-12  0.00094942905  6.4556589e-09  4.4060418e-09  21.97245       21.972448      1              482.78851    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.0944373 on 1 procs for 200 steps with 499 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
    1.07585256619822e-07 6.75790167226578e-13 6.23562528045991e-13
  Force two-norm initial, final = 0.00096538402 5.3694426e-07
  Force max component initial, final = 0.00010100601 7.9482564e-08
  Final line search alpha, max atom move = 1 7.9482564e-08
  Iterations, force evaluations = 200 400

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.08023    | 0.08023    | 0.08023    |   0.0 | 84.96
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0083374  | 0.0083374  | 0.0083374  |   0.0 |  8.83
Output  | 2.0898e-05 | 2.0898e-05 | 2.0898e-05 |   0.0 |  0.02
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.005849   |            |       |  6.19

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0


# fix 69 all ave/time 1 $M $M v_pxx v_pyy v_pzz v_pxy v_pxz v_pyz
# Obtain new stress tensor
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 0.0156809853814226
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 0.0288181180800613
# variable tmp equal pzz
# variable pzz1 equal ${tmp}
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 0.000949429047383458
# variable tmp equal pxz
# variable pxz1 equal ${tmp}
# variable tmp equal pyz
# variable pyz1 equal ${tmp}

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.0156379006378433
variable C2neg equal ${d2}
variable C2neg equal 0.0288092537029419
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
variable C6neg equal ${d6}
variable C6neg equal 0.000924230209500761

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style full from restart
  triclinic box = (-4.3478258e-07 4.9252223e-07 0) to (21.972449 21.972449 1) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  restoring bond style harmonic from restart
  restoring angle style harmonic from restart
  restoring dihedral style zero from restart
  499 atoms
  915 bonds
  3221 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.8333333333333334
     6 = max # of 1-2 neighbors
    21 = max # of 1-3 neighbors
    87 = max # of 1-4 neighbors
    32 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.002 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# EXAMPLE SCRIPT
#------------------------------------------------------
# # Choose potential
# pair_style	sw
# pair_coeff * * Si.sw Si

# # Setup neighbor style
# neighbor 1.0 nsq
# neigh_modify once no every 1 delay 0 check yes

# # Setup minimization style
# min_style	     cg
# min_modify	     dmax ${dmax} line quadratic

# # Setup output
# thermo		1
# thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
# thermo_modify norm no

# COPIED FROM MODIFIED SCRIPT
#------------------------------------------------------
# Setup neighbor style
neighbor 3.0 nsq
neigh_modify once no every 1 delay 0 check yes
comm_modify cutoff 2.0

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

timestep	0.001


# Setup output
thermo		100
thermo_style custom step temp pe ebond eangle edihed press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.0001*${len0}
variable delta equal 0.0001*21.9724480149555
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.0001*xy
# variable deltaxz equal ${up}*xz
# variable deltayz equal ${up}*yz
if "${dir} == 1" then    "fix 42 all deform 1 x erate ${srate} units box remap x"    "run  ${nsteps}"
if "${dir} == 2" then    "fix 42 all deform 1 y erate ${srate} units box remap x"    "run  ${nsteps}"
# if "${dir} == 1" then #    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
# if "${dir} == 2" then #    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
# if "${dir} == 3" then #    "change_box all z delta 0 ${delta} remap units box"
# if "${dir} == 4" then #    "change_box all yz delta ${delta} remap units box"
# if "${dir} == 5" then #    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "fix 42 all deform 1 xy erate ${srate} units box remap x"    "run  ${nsteps}"
fix 42 all deform 1 xy erate ${srate} units box remap x
fix 42 all deform 1 xy erate 1e-05 units box remap x
run  ${nsteps}
run  2000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0
  ghost atom cutoff = 2
  0 neighbor lists, perpetual/occasional/extra = 0 0 0
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 11.77 | 11.77 | 11.77 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
       200   0              6.2020268e-08  6.2020268e-08  0              0             -0.0018255493  -0.33306444     0.3275878     -1.1616838e-10 -0.031468812   -5.2083673e-06  1.1110514e-05  21.97245       21.972448      1              482.78851    
       300   0              6.2141766e-08  6.2141766e-08  0              0             -0.022641942   -0.36898094     0.30105511    -1.3280167e-10 -0.78308191    -4.59876e-06    1.152066e-05   21.97245       21.972448      1              482.78851    
       400   0              6.2492121e-08  6.2492121e-08  0              0             -0.043669873   -0.40526293     0.27425331    -1.4960303e-10 -1.5422872     -3.9829942e-06  1.1934948e-05  21.97245       21.972448      1              482.78851    
       500   0              6.307125e-08   6.307125e-08   0              0             -0.064699083   -0.44154765     0.2474504     -1.6640445e-10 -2.3014926     -3.3672276e-06  1.2349235e-05  21.97245       21.972448      1              482.78851    
       600   0              6.3879152e-08  6.3879152e-08  0              0             -0.085729571   -0.47783508     0.22064636    -1.8320593e-10 -3.0606982     -2.75146e-06    1.2763523e-05  21.97245       21.972448      1              482.78851    
       700   0              6.4915828e-08  6.4915828e-08  0              0             -0.10676134    -0.51412523     0.19384121    -2.0000747e-10 -3.8199039     -2.1356915e-06  1.317781e-05   21.97245       21.972448      1              482.78851    
       800   0              6.6181278e-08  6.6181278e-08  0              0             -0.12779438    -0.55041809     0.16703495    -2.1680907e-10 -4.5791098     -1.5199221e-06  1.3592097e-05  21.97245       21.972448      1              482.78851    
       900   0              6.7675501e-08  6.7675501e-08  0              0             -0.1488287     -0.58671368     0.14022757    -2.3361073e-10 -5.3383157     -9.041518e-07   1.4006383e-05  21.97245       21.972448      1              482.78851    
      1000   0              6.9398498e-08  6.9398498e-08  0              0             -0.16986431    -0.62301199     0.11341907    -2.5041245e-10 -6.0975219     -2.8838055e-07  1.442067e-05   21.97245       21.972448      1              482.78851    
      1100   0              7.1350269e-08  7.1350269e-08  0              0             -0.19090119    -0.65931301     0.08660945    -2.6721423e-10 -6.8567281      3.2739157e-07  1.4834956e-05  21.97245       21.972448      1              482.78851    
      1200   0              7.3530814e-08  7.3530814e-08  0              0             -0.21193934    -0.69561675     0.059798718   -2.8401607e-10 -7.6159345      9.4316461e-07  1.5249241e-05  21.97245       21.972448      1              482.78851    
      1300   0              7.5940133e-08  7.5940133e-08  0              0             -0.23297878    -0.73192321     0.032986868   -3.0081797e-10 -8.3751411      1.5589385e-06  1.5663527e-05  21.97245       21.972448      1              482.78851    
      1400   0              7.8578226e-08  7.8578226e-08  0              0             -0.2540195     -0.76823239     0.0061739011  -3.1761992e-10 -9.1343477      2.1747134e-06  1.6077812e-05  21.97245       21.972448      1              482.78851    
      1500   0              8.1445092e-08  8.1445092e-08  0              0             -0.27506149    -0.80454429    -0.020640182   -3.3442194e-10 -9.8935546      2.7904891e-06  1.6492097e-05  21.97245       21.972448      1              482.78851    
      1600   0              8.4540733e-08  8.4540733e-08  0              0             -0.29610476    -0.84085891    -0.04745538    -3.5122402e-10 -10.652762      3.4062658e-06  1.6906381e-05  21.97245       21.972448      1              482.78851    
      1700   0              8.7865148e-08  8.7865148e-08  0              0             -0.31714931    -0.87717624    -0.074271696   -3.6802615e-10 -11.411969      4.0220433e-06  1.7320665e-05  21.97245       21.972448      1              482.78851    
      1800   0              9.1418336e-08  9.1418336e-08  0              0             -0.33819514    -0.9134963     -0.10108913    -3.8482835e-10 -12.171176      4.6378218e-06  1.7734949e-05  21.97245       21.972448      1              482.78851    
      1900   0              9.5200299e-08  9.5200299e-08  0              0             -0.35924225    -0.94981907    -0.12790768    -4.0163061e-10 -12.930383      5.2536012e-06  1.8149233e-05  21.97245       21.972448      1              482.78851    
      2000   0              9.9211037e-08  9.9211037e-08  0              0             -0.38029064    -0.98614456    -0.15472734    -4.1843292e-10 -13.689591      5.8693814e-06  1.8563516e-05  21.97245       21.972448      1              482.78851    
      2100   0              1.0345055e-07  1.0345055e-07  0              0             -0.4013403     -1.0224728     -0.18154813    -4.352353e-10  -14.448798      6.4851626e-06  1.8977799e-05  21.97245       21.972448      1              482.78851    
      2200   0              1.0791883e-07  1.0791883e-07  0              0             -0.42239124    -1.0588037     -0.20837002    -4.5203774e-10 -15.208006      7.1009447e-06  1.9392082e-05  21.97245       21.972448      1              482.78851    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.39958 on 1 procs for 2000 steps with 499 atoms

Performance: 432.454 ns/day, 0.055 hours/ns, 5005.254 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.34055    | 0.34055    | 0.34055    |   0.0 | 85.23
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.041362   | 0.041362   | 0.041362   |   0.0 | 10.35
Output  | 0.00021542 | 0.00021542 | 0.00021542 |   0.0 |  0.05
Modify  | 0.012202   | 0.012202   | 0.012202   |   0.0 |  3.05
Other   |            | 0.005247   |            |       |  1.31

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 200 ${maxeval}
minimize 0 1e-10 200 2000
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:970)
WARNING: Communication cutoff 2 is shorter than a bond length based estimate of 5.61403875. This may lead to errors. (src/comm.cpp:727)
WARNING: Inconsistent image flags (src/domain.cpp:819)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Per MPI rank memory allocation (min/avg/max) = 12.9 | 12.9 | 12.9 Mbytes
   Step          Temp          PotEng         E_bond        E_angle        E_dihed         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
      2200   0              1.0796467e-07  1.0796467e-07  0              0             -0.42260176    -1.059167      -0.20863825    -4.5220576e-10 -15.215598      7.1071025e-06  1.9396225e-05  21.97245       21.972448      1              482.78851    
      2300   0              4.941124e-11   4.941124e-11   0              0             -0.31175947    -0.50212643    -0.43315199    -6.9850783e-11 -0.014579231    4.9515777e-08  7.8149132e-08  21.97245       21.972448      1              482.78851    
      2400   0              6.2123934e-13  6.2123934e-13  0              0             -0.015066415   -0.015077874   -0.03012137    -3.4460821e-12 -0.00020434342  5.3073615e-09  1.0739626e-08  21.97245       21.972448      1              482.78851    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:940)
Loop time of 0.0951961 on 1 procs for 200 steps with 499 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
    1.07964671740979e-07 6.74788264564059e-13 6.21239342980673e-13
  Force two-norm initial, final = 0.0009733765 5.2083045e-07
  Force max component initial, final = 9.8279549e-05 6.3793759e-08
  Final line search alpha, max atom move = 1 6.3793759e-08
  Iterations, force evaluations = 200 400

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 0.081081   | 0.081081   | 0.081081   |   0.0 | 85.17
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0082493  | 0.0082493  | 0.0082493  |   0.0 |  8.67
Output  | 1.9718e-05 | 1.9718e-05 | 1.9718e-05 |   0.0 |  0.02
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.005846   |            |       |  6.14

Nlocal:            499 ave         499 max         499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           3031 ave        3031 max        3031 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 24.472946
Neighbor list builds = 0
Dangerous builds = 0


# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal 6.21239342980673e-13
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -0.0150664146508096
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.0150778737242746
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.0301213702247082
# variable tmp equal pzz
# variable pzz1 equal ${tmp}
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -0.000204343417595044
# variable tmp equal pxz
# variable pxz1 equal ${tmp}
# variable tmp equal pyz
# variable pyz1 equal ${tmp}

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.0151209584678539
variable C2pos equal ${d2}
variable C2pos equal 0.0301302346018276
# variable C3pos equal ${d3}
# variable C4pos equal ${d4}
# variable C5pos equal ${d5}
variable C6pos equal ${d6}
variable C6pos equal 0.000229542255477741

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(0.0156379006378433+${C1pos})
variable C16 equal 0.5*(0.0156379006378433+0.0151209584678539)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(0.0288092537029419+${C2pos})
variable C26 equal 0.5*(0.0288092537029419+0.0301302346018276)
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(0.000924230209500761+${C6pos})
variable C66 equal 0.5*(0.000924230209500761+0.000229542255477741)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 0.00244004682806335
variable C22all equal ${C22}
variable C22all equal 0.00214204709307395
# variable C33all equal ${C33}

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-0.0205984256015322+${C21})
variable C12all equal 0.5*(-0.0205984256015322+-0.0258651900785719)
# variable C13all equal 0.5*(${C13}+${C31})
# variable C23all equal 0.5*(${C23}+${C32})

# variable C44all equal ${C44}
# variable C55all equal ${C55}
variable C66all equal ${C66}
variable C66all equal 0.000576886232489251

# variable C14all equal 0.5*(${C14}+${C41})
# variable C15all equal 0.5*(${C15}+${C51})
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(0.0153794295528486+${C61})
variable C16all equal 0.5*(0.0153794295528486+0.00330693345539562)

# variable C24all equal 0.5*(${C24}+${C42})
# variable C25all equal 0.5*(${C25}+${C52})
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(0.0294697441523847+${C62})
variable C26all equal 0.5*(0.0294697441523847+0.0115323232757092)

# variable C34all equal 0.5*(${C34}+${C43})
# variable C35all equal 0.5*(${C35}+${C53})
# variable C36all equal 0.5*(${C36}+${C63})

# variable C45all equal 0.5*(${C45}+${C54})
# variable C46all equal 0.5*(${C46}+${C64})
# variable C56all equal 0.5*(${C56}+${C65})

# Average moduli for cubic crystals

# variable C11cubic equal (${C11all}+${C22all})/2.0
# variable C12cubic equal ${C12all}
# variable C44cubic equal ${C66all}

variable bulkmodulus equal (${C11all}+${C22all}+2*${C12all})/4.0
variable bulkmodulus equal (0.00244004682806335+${C22all}+2*${C12all})/4.0
variable bulkmodulus equal (0.00244004682806335+0.00214204709307395+2*${C12all})/4.0
variable bulkmodulus equal (0.00244004682806335+0.00214204709307395+2*-0.023231807840052)/4.0
variable shearmodulus1 equal ${C66all} # simple
variable shearmodulus1 equal 0.000576886232489251 
variable shearmodulus2 equal (${C11all}+${C22all}-${C12all})/3.0 # pure
variable shearmodulus2 equal (0.00244004682806335+${C22all}-${C12all})/3.0 
variable shearmodulus2 equal (0.00244004682806335+0.00214204709307395-${C12all})/3.0 
variable shearmodulus2 equal (0.00244004682806335+0.00214204709307395--0.023231807840052)/3.0 
# (1 - G/B)/(1+G/B)
variable poissonratio equal (1-(${shearmodulus2}+${shearmodulus1})/${bulkmodulus})/(1+(${shearmodulus2}+${shearmodulus1})/${bulkmodulus})
variable poissonratio equal (1-(0.0092713005870631+${shearmodulus1})/${bulkmodulus})/(1+(${shearmodulus2}+${shearmodulus1})/${bulkmodulus})
variable poissonratio equal (1-(0.0092713005870631+0.000576886232489251)/${bulkmodulus})/(1+(${shearmodulus2}+${shearmodulus1})/${bulkmodulus})
variable poissonratio equal (1-(0.0092713005870631+0.000576886232489251)/-0.0104703804397417)/(1+(${shearmodulus2}+${shearmodulus1})/${bulkmodulus})
variable poissonratio equal (1-(0.0092713005870631+0.000576886232489251)/-0.0104703804397417)/(1+(0.0092713005870631+${shearmodulus1})/${bulkmodulus})
variable poissonratio equal (1-(0.0092713005870631+0.000576886232489251)/-0.0104703804397417)/(1+(0.0092713005870631+0.000576886232489251)/${bulkmodulus})
variable poissonratio equal (1-(0.0092713005870631+0.000576886232489251)/-0.0104703804397417)/(1+(0.0092713005870631+0.000576886232489251)/-0.0104703804397417)
# variable poissonratio equal 1.0/(1.0+((${C11all}+${C22all})/2.0)/${C12all})
# 1.0/(1.0+${C11cubic}/${C12cubic})


# dump 8 all atom 1000 deform_dump.lammpstrj

# variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
# variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
# variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0

# variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
# variable shearmodulus1 equal ${C44cubic}
# variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
# variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 0.00244004682806335 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 0.00214204709307395 GPa
# print "Elastic Constant C33all = ${C33all} ${cunits}"

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = -0.023231807840052 GPa
# print "Elastic Constant C13all = ${C13all} ${cunits}"
# print "Elastic Constant C23all = ${C23all} ${cunits}"

# print "Elastic Constant C44all = ${C44all} ${cunits}"
# print "Elastic Constant C55all = ${C55all} ${cunits}"
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 0.000576886232489251 GPa

# print "Elastic Constant C14all = ${C14all} ${cunits}"
# print "Elastic Constant C15all = ${C15all} ${cunits}"
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = 0.00934318150412211 GPa

# print "Elastic Constant C24all = ${C24all} ${cunits}"
# print "Elastic Constant C25all = ${C25all} ${cunits}"
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = 0.020501033714047 GPa

# print "Elastic Constant C34all = ${C34all} ${cunits}"
# print "Elastic Constant C35all = ${C35all} ${cunits}"
# print "Elastic Constant C36all = ${C36all} ${cunits}"

# print "Elastic Constant C45all = ${C45all} ${cunits}"
# print "Elastic Constant C46all = ${C46all} ${cunits}"
# print "Elastic Constant C56all = ${C56all} ${cunits}"

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = -0.0104703804397417 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 0.000576886232489251 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 0.0092713005870631 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 32.6563413702483
Total wall time: 0:00:03
